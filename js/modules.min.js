"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}(),socket=io("https://easycode-test-chat.herokuapp.com/"),Chat=function(){function e(){_classCallCheck(this,e);this.chat_room_item_container=document.querySelector(".chat-rooms-list"),this.messageContainer=document.querySelector(".message-container"),this.class=""}return _createClass(e,[{key:"verify",value:function(e){return console.log(e),new Promise(function(t,n){socket.emit("verify",e,function(e,s){e&&n(e),t(s)})})}},{key:"getUsers",value:function(){return new Promise(function(e,t){socket.emit("getUsers",function(n){n||t("Users not found"),e(n)})})}},{key:"sendMessage",value:function(e,t){socket.emit("chatMessage",e,t)}},{key:"writeMessage",value:function(e){socket.emit("writeMessage",e)}},{key:"renderUsers",value:function(e){e.forEach(function(e){var t=chat.userItemTemplate(e);chat.chat_room_item_container.insertAdjacentHTML("beforeend",t)})}},{key:"userItemTemplate",value:function(e){return'\n            <div class="chat-room-item d-flex align-items-center">\n                <div class="chat-room-user-ava">\n                    <img src="img/chat-room-item-ava.png" alt="">\n                    <span class="new-msg-count"></span>\n                </div>\n                \x3c!-- / chat-room-user-ava --\x3e\n\n                <div class="chat-room-user-info">\n                    <span class="chat-room-user-name">'+e.name+'</span>\n    \n                    <div class="chat-room-last-msg d-flex justify-content-between">\n                        <span class="last-msg">'+e.lastMessage+'</span>\n                        <span class="last-msg-time">1 min</span>\n                    </div>\n                    \x3c!-- / chat-room-last-msg --\x3e\n                    \n                    <span class="chat-room-user-status online"></span>\n                </div>\n            </div>\n        '}},{key:"renderMessage",value:function(e,t){var n=this.newMessage(e,t);this.messageContainer.insertAdjacentHTML("beforeend",n)}},{key:"newMessage",value:function(e,t){return this.class=t.name.toLowerCase()||t.querySelector(".chat-room-user-name").textContent.toLowerCase()==JSON.parse(localStorage.user).name.toLowerCase()?"from-you":"to-you",'\n            <div class="message '+this.class+'" >\n                <img src="img/user-message-ava.png" alt="">\n                <div class="message-text">\n                    '+t.lastMessage+" \n                </div>\n            </div>\n        "}},{key:"textFromUsers",value:function(){return this.allUsersText}}]),e}(),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}(),Modal=function(){function e(t){_classCallCheck(this,e),this.modal=document.querySelector(t),this.overlay=document.querySelector(".overlay"),this.modalBtn=this.modal.querySelector(".btn")}return _createClass(e,[{key:"show",value:function(){this.modal.classList.add("show"),this.overlay.classList.add("show")}},{key:"hide",value:function(){this.modal.classList.remove("show"),this.overlay.classList.remove("show")}},{key:"show_error",value:function(e){this.modalBtn.insertAdjacentHTML("beforebegin","<p>"+e+"</p>")}}]),e}(),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}(),Validate=function(){function e(t){_classCallCheck(this,e),this.form=t}return _createClass(e,[{key:"init",value:function(){if(!this.form)return console.error("Form tag not found");this.form_inputs=[].slice.call(this.form.elements),this.inputs_required=this.form_inputs.filter(function(e){return e.hasAttribute("data-required")}),this.form_valid_toggle=!1,this.validate_inputs()}},{key:"validate_inputs",value:function(){return this.form_valid_toggle=this.inputs_required.every(function(e){var t=new RegExp(e.dataset.required,"g"),n=e.value;return userInfo[e.name]=n,t.test(n)}),this.form_valid_toggle||enterModal.show_error("Incorrect email or password"),this.form_valid_toggle}}]),e}();